---
title: "EnSusalud"
author: "Jessica Zafra"
date: "2024-09-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r loading packages, echo=FALSE, message=FALSE}

if(!require(pacman)) install.packages("pacman")
pacman::p_load(tidyverse, 
               knitr, 
               here,
               janitor,
               inspectdf,
               gtsummary,
               haven,
               stringi)

```

## Introducción

La percepción de corrupción, discriminación y violencia son fenómenos complejos que afectan a diversos sectores de la sociedad, incluyendo el ámbito de la salud. En los trabajadores de salud, estos factores pueden tener implicaciones significativas no solo en su bienestar emocional, sino también en la calidad de los servicios que brindan (Hennein et al., 2023; Mackey & Liang, 2012). La percepción de corrupción, en particular, ha sido asociada con un deterioro en la confianza hacia las instituciones y una disminución en la satisfacción laboral por parte de los trabajadores (León et al., 2014). Además, una mayor percepción de corrupción se asocia inversamente con la percepción de bienestar en trabajadores (J et al., 2022).

Por otro lado, la discriminación en el lugar de trabajo ha mostrado una fuerte relación con el desarrollo de problemas emocionales, como la ansiedad y los trastornos del sueño (Maglalang et al., 2021; Ormiston et al., 2024). Además, la percepción de ser discriminados también se asocia negativamente con el desempeño y la calidad de atención que brindan por parte de los trabajadores (del Carmen Triana et al., 2015; Pascoe & Smart Richman, 2009).

La violencia, tanto física como verbal, representa un desafío significativo para el personal de salud. Un meta-análisis reveló que el 42.5% de los trabajadores de salud reportó haber estado expuesto a violencia no física, mientras que el 24.4% experimentó violencia física en el último año (Liu et al., 2019). Además, se observó una alta prevalencia de abuso verbal (57.6%), amenazas (33.2%), y acoso sexual (12.4%) en los trabajadores de salud (Liu et al., 2019). Además, experiencias de violencia se asocian fuertemente a la presencia de problemas emocionales como síntomas depresivos y ansiosos (A et al., 2022).

Dado este contexto, el presente estudio tiene como objetivo explorar las asociaciones entre la percepción de corrupción, discriminación y violencia con la presencia de problemas emocionales en una muestra de trabajadores de salud peruanos. Este enfoque permitirá identificar áreas críticas de intervención para mejorar tanto la salud mental del personal como la calidad de los servicios de salud.

## Métodos

### Diseño de estudio
Estudio secundario en el cuál se analizó un piloto de la Encuesta Nacional de Satisfacción del personal de salud de hospitales del Ministerio de Salud y Gobiernos Regionales en el Sistema de Salud Peruano (ENSUSALUD 2024).

Esta encuesta tuvo un diseño transversal y fue realizada en profesionales de salud que trabajan en hospitales públicos adscritos al Ministerio de Salud (MINSA) y los Gobiernos Regionales (GOREs) en Perú durante el primer semestre del año 2024.

### Población
Se incluyó a profesionales profesionales de medicina, enfermería u obstreticia en las IPRESS seleccionados por al menos 12 meses continuos en la IPRESS. Se excluyó a aquellos que no puedan responder debido a un accidente cerebro vascular con secuelas, aquellos que no desean participar o que no firmen el consentimiento informado. Además, se excluyó a aquellos que realicen exclusivamente teletrabajo.

Se eliminó de la base de datos a aquellos que no completaron el cuestionario por completo.

### Tamaño de muestra


### Muestreo 

Se realizó un muestreo por conveniencia. El personal de campo buscó entrevistar profesionales de salud en los establecimientos de salud.

### Variables y medición
Se consideraron variables sociodemográficas como: ...

Además, las variables de interés corrupción, discriminación y violencia...

### Análisis de datos

Se realizó una limpieza de la base de datos. Para ello se homogenizó las categorías de respuesta de las variables categóricas y, para las variables numéricas, se eliminó valores implausibles.


```{r = explorando base, echo=FALSE, message=FALSE}

#data <- readxl::read_xlsx(here("data/Database_4_non-id.xlsx")) %>% 
  #select(1:24, 84:99, 143:145) #violencia, corrupcion

data2 <- readxl::read_xlsx(here("data/Database_4.xlsx")) %>% 
  clean_names() %>% 
  rename(id = ingresar_un_codigo_alfanumerico_por_participante_iniciales_y_numero_de_participante,
         nombre_ipress = nombre_de_la_ipress,
         distrito_ipress = distrito,
         profesion = x1_cual_es_su_profesion,
         edad = x2_cual_es_su_edad,
         departamento = x3_1_en_que_departamento_vive,
         provincia = x3_2_en_que_provincia_vive,
         distrito = x3_3_en_que_distrito_vive,
         sexo = x4_cual_es_su_sexo,
         estado_civil = x5_cual_es_su_estado_civil_o_conyugal,
         grupo_etnico = x6_del_listado_mostrado_con_que_grupo_etnico_usted_de_identifica,
         vivienda = x7_la_vivienda_que_ocupa_en_su_hogar_es,
         idioma = x8_con_respecto_al_dominio_de_otro_idioma_distinto_al_espanol_usted_domina,
         vive_familia = x9_actualmente_usted_vive_con_su_familia,
         fuente_ingreso = x10_usted_es_la_unica_fuente_de_ingresos_de_su_hogar,
         dependientes = x11_cuantas_personas_dependen_economicamente_de_usted,
         dejo_familia = x12_actualmente_usted_ha_tenido_que_viajar_y_dejar_a_su_familia_para_trabajar_en_este_establecimiento,
         universidad = x13_en_que_universidad_se_titulo,
         ano_titulacion = x14_en_que_ano_obtuvo_su_titulo_universitario,
         especialidad = x16_tiene_alguna_especialidad_o_subespecialidad,
         dejar_eess = x25_actualmente_piensa_o_tiene_planificado_dejar_de_trabajar_en_este_establecimiento,
         factor_dejar_eess = x26_que_factores_influirian_mas_en_usted_para_cambiar_de_trabajo,
         tiempo_eess = x28_cuantos_anos_viene_laborando_en_este_establecimiento_de_salud,
         horas_semana = x33_en_promedio_cuantas_horas_trabaja_a_la_semana_en_todas_sus_actividades_remuneradas,
         agresion_fisica = x59_alguna_vez_durante_su_vida_profesional_ha_sido_agredido_a_fisicamente_en_su_lugar_de_trabajo,
         agresion_fisica_quien = x60_respecto_a_la_agresion_o_agresiones_fisicas_recibidas_en_su_lugar_de_trabajo_quien_o_quienes_fueron_los_agresores,
         agresion_fisica_12m = x61_en_los_ultimos_12_meses_usted_ha_sido_agredido_a_fisicamente_en_su_lugar_de_trabajo,
         agresion_fisica_12m_quien = x62_respecto_a_la_agresion_o_agresiones_fisicas_recibidas_en_su_lugar_de_trabajo_en_los_ultimos_12_meses_quien_o_quienes_fueron_los_agresores,
         agresion_insulto = x64_alguna_vez_durante_su_vida_profesional_ha_sido_insultado_en_su_lugar_de_trabajo,
         agresion_insulto_quien = x65_respecto_a_haber_sido_insultado_en_su_lugar_de_trabajo_quien_o_quienes_lo_o_la_insultaron,
         agresion_insulto_12m = x66_en_los_ultimos_12_meses_usted_ha_sido_insultado_en_su_lugar_de_trabajo,
         agresion_insulto_12m_quien = x67_respecto_a_haber_sido_insultado_en_su_lugar_de_trabajo_en_los_ultimos_12_meses_quien_o_quienes_fueron_los_agresores,
         agresion_amenaza = x69_alguna_vez_durante_su_vida_profesional_ha_sido_amenazado_en_su_lugar_de_trabajo,
         agresion_amenaza_quien = x70_respecto_a_haber_sido_amenazado_en_su_lugar_de_trabajo_quien_o_quienes_fueron_los_agresores,
         agresion_amenaza_12m = x71_en_los_ultimos_12_meses_usted_ha_sido_amenazado_en_su_lugar_de_trabajo, 
         agresion_amenaza_12m_quien = x72_respecto_a_haber_sido_amenazado_en_su_lugar_de_trabajo_en_los_ultimos_12_meses_quien_o_quienes_lo_amenazaron,
         agresion_sexual = x74_alguna_vez_durante_su_vida_profesional_ha_sido_acosado_a_sexualmente_en_su_lugar_de_trabajo,
         agresion_sexual_quien = x75_respecto_a_haber_sido_acosado_a_sexualmente_en_su_lugar_de_trabajo_quien_o_quienes_lo_la_acosaron,
         agresion_sexual_12m = x76_en_los_ultimos_12_meses_usted_ha_sido_acosado_a_sexualmente_en_su_lugar_de_trabajo,
         agresion_sexual_12m_quien = x77_respecto_a_haber_sido_acosado_a_sexualmente_en_su_lugar_de_trabajo_en_los_ultimos_12_meses_quien_o_quienes_lo_la_acosaron,
         corrupcion = x92_cual_es_el_nivel_de_corrupcion_que_usted_percibe_en_el_sistema_de_salud_del_peru,
         discriminacion = x93_en_los_ultimos_12_meses_usted_ha_sido_victima_de_algun_acto_de_discriminacion_en_el_sistema_de_salud_peruano) %>% 
  mutate(distrito_ipress = stri_trans_general(str_to_title(distrito_ipress), "Latin-ASCII"),
         distrito_ipress = case_when(distrito_ipress == "Vitarte" ~ "Ate Vitarte",
                                     TRUE ~ distrito_ipress),
         edad = as.numeric(edad),
         departamento = stri_trans_general(str_to_title(departamento), "Latin-ASCII"),
         departamento = case_when(departamento == "Arequip" ~ "Arequipa",
                                  departamento == "San Borja" ~ "Lima",
                                  departamento == "Tarma" ~ "Junin",
                                  departamento == "Cabana" ~ "Puno",
                                  TRUE ~ departamento),
         provincia = stri_trans_general(str_to_title(provincia), "Latin-ASCII"),
         distrito = stri_trans_general(str_to_title(distrito), "Latin-ASCII"),
         distrito = case_when(distrito == "Ate" ~ "Ate Vitarte",
                              distrito == "Chorrilllos" ~ "Chorrillos",
                              distrito == "Puenlo.libre" ~ "Pueblo Libre",
                              distrito == "San Martin Porres" ~ "San Martin De Porres",
                              distrito == "Rupa- Rupa" ~ "Rupa-Rupa",
                              distrito == "Chaclayo" ~ "Chiclayo",
                              TRUE ~ distrito),
         grupo_etnico = case_when(grupo_etnico == "2"  ~ "Aimara",
                                  grupo_etnico == "23" ~ "Kandozi",
                                  grupo_etnico == "40" ~ "Quechuas",
                                  grupo_etnico == "49" ~ "Uro",
                                  grupo_etnico == "50" ~ "Vacacocha",
                                  grupo_etnico == "57" ~ "Blanco",
                                  grupo_etnico == "58" ~ "Mestizo",
                                  grupo_etnico == "59" ~ "Asiatico Descendiente"),
         vivienda = stri_trans_general(str_to_title(vivienda), "Latin-ASCII"),
         vivienda = case_when(
    # Group 1: CASA FAMILIAR
           vivienda %in% c("Casa De Hna", 
                                  "Casa Familiar", 
                                  "Casa Familiar (Familia Paterna)", 
                                  "Familiar", 
                                  "Vivienda De Padres", 
                                  "Vive En Casa De Su Madre", 
                                  "Vivienda Familiar", 
                                  "Casa De Los Padres", 
                                  "Casa De Padres", 
                                  "Casa De Sus Padres", 
                                  "Casa De Un Familiar", 
                                  "De Mis Padres", 
                                  "De Sus Padres", 
                                  "Casa De Los Padres", 
                                  "Casa De Mis Padres", 
                                  "Casa De Un Familiar", 
                                  "De Sus Padres") ~ "Casa Familiar",
    
    # Group 2: ALQUILADA
    vivienda == "?Alquilada?" ~ "Alquilada",
    
    # Group 3: CEDIDA
    vivienda == "?Cedida por otro hogar o institutción?" ~ "Cedida",
    
    # Group 4: PROPIA, PAGANDO
    vivienda == "?Propia, Pagando A Plazos O Cuotas?" ~ "Propia, Pagando",
    
    # Group 5: PROPIA, TOTALMENTE PAGADA
    vivienda == "?Propia, Totalmente Pagada?" ~ "Propia, Totalmente Pagada",
    
    # Group 6: OTROS
    vivienda %in% c("Heredada", 
                    "Herencia de mi suegro", 
                    "Propia/Herencia") ~ "Otros",
    
    # Keep existing values if no match
    TRUE ~ vivienda
  ),
  horas_semana = case_when(horas_semana > 80 ~ NA,
                           TRUE ~ horas_semana),
  ano_titulacion = case_when(ano_titulacion == 20 ~ 2020,
                               TRUE ~ ano_titulacion),
  tiempo_titulo = 2024 - ano_titulacion,
  tiempo_eess = case_when(tiempo_eess > tiempo_titulo ~ NA,
                          TRUE ~ tiempo_eess),
  across(.cols = c(agresion_fisica, agresion_insulto, agresion_amenaza, agresion_sexual), 
                .fns = ~case_when(. == "Si, más de una vez" ~ "Si",
        . == "Si, sólo una vez" ~ "Si",
        TRUE ~ "No")),
        across(.cols = c(agresion_fisica_12m, agresion_insulto_12m, agresion_amenaza_12m, agresion_sexual_12m), 
                .fns = ~case_when(. == "Si, más de una vez" ~ "Si",
        . == "Si, sólo una vez" ~ "Si",
        is.na(.) ~ NA_character_,
        TRUE ~ "No")),
  corrupcion = str_to_title(corrupcion),
  corrupcion = factor(corrupcion, levels = c("Muy Bajo", "Bajo", "Moderado", "Alto", "Muy Alto")),
  corrupcion_2 = case_when(corrupcion == "Muy Bajo" | corrupcion == "Bajo" ~ "Bajo",
                           corrupcion == "Moderado" ~ "Moderado",
                           corrupcion == "Alto" | corrupcion == "Muy Alto" ~ "Alto"),
  corrupcion_2 = factor(corrupcion_2, levels = c("Bajo", "Moderado", "Alto")),
  discriminacion = case_when(discriminacion == "No" ~ "No",
                             TRUE ~ "Si"))

#No considerando las siguientes variables: idioma, vive_familia, fuente_ingreso, universidad

#evaluar si es de interes: factor_dejar_eess

#cleaning outcomes

#data2 %>% count(corrupcion_2)
  

#str(data2)
#names(data2) 
#get_dupes(data2) # no duplicates


```

## Resultados

### Muestra

```{r datos sobre la muestra, echo=FALSE, message=FALSE}
# Muestreo
n_muestra <- data2 %>% 
  summarize(n_participantes = nrow(data2),
            n_ipress = n_distinct(codigo_renipress),
            n_distrito_ipress = n_distinct(distrito_ipress))
```

Se entrevistó a un total de `r n_muestra[1,1]` que laboraban en `r n_muestra[1,2]` establecimientos de salud localizados en `r n_muestra[1,3]` distritos del país.

### Descripción de la población de estudio


```{r variables sociodemográficas, echo=FALSE, message=FALSE}
#Tabla 1. Descripción de la población
#revisando variables sociodemograficas
tabla1 <- data2 %>% 
  select(c(edad, profesion, sexo, estado_civil, grupo_etnico, vivienda, dependientes,dejo_familia)) %>% 
  tbl_summary(statistic = list(edad ~ "{median} ({min} - {max})"),
              label = list(edad = "Edad (años)",
               profesion = "Profesión",
               sexo = "Sexo",
               estado_civil = "Estado civil",
               grupo_etnico = "Grupo étnico",
               vivienda = "Tipo de vivienda",
               dependientes = "Número de personas dependientes del participante",
               dejo_familia = "Tuvo que dejar familia por trabajo")) %>%
  modify_header(label ~ "**Características**") %>%
   modify_caption("**Tabla 1: Resumen descriptivo de las variables sociodemográficas**")

per_mujer <- tabla1 %>%
  inline_text(variable = "sexo", level = "Mujer")

edad_sum <- data2 %>% 
  summarize(median = median(edad, na.rm = T),
            min = min(edad, na.rm = T),
            max = max(edad, na.rm = T))

prof_sum <- data2 %>% 
  select(profesion) %>% 
  group_by(profesion) %>% 
  summarize(count = n(),
            perc = round((count/nrow(data2)*100),1)) %>% 
  arrange(desc(count))

#inspect_num(data2) %>% 
 # show_plot()
```

La mediana de la edad de los participantes fue de `r edad_sum[1,1]` años con un rango de `r edad_sum[1,2]` a `r edad_sum[1,3]`. `r per_mujer` de los participantes fueron de sexo femenino. La mayoría tenía como profesión `r prof_sum[1,1]` (`r prof_sum[1,2]`, `r prof_sum[1,3]`%).

La siguiente tabla muestra las características sociodemográficas de los participantes.

```{r echo=FALSE, message=FALSE}

tabla1

```

```{r especialidad, echo=FALSE, message=FALSE}

esp_sum <- data2 %>% 
  select(especialidad) %>% 
  group_by(especialidad) %>% 
  summarise(count = n(),
            per_esp = round((count/nrow(data2)*100),1)) %>% 
  arrange(desc(count))

```

La mayoría de los participantes se titularon en los últimos 15 años. La mayoría (`r esp_sum[2,1]`, `r esp_sum[3,1]`%) contaba con una especialidad y `r esp_sum[2,3]` (`r esp_sum[3,3]`%) estaban realizando una.

En el siguiente gráfico se puede observar la distribución del año de titulación.

```{r echo=FALSE, message=FALSE}

ano_titulacion_graph <- data2 %>% 
  ggplot(aes(x = ano_titulacion)) +
  geom_histogram() +
  labs(title = "Distribución del año de titulación de los participantes",
       x = "Año de titulación",
       y = "N") +
  theme_minimal()

```


### Descripción de las variables de interés

#### Violencia

Se evaluaron distintos tipos de violencia como violencia física, verbal (insultos y amenazas) y acoso sexual. Se preguntó por estas experiencias en el ambiente laboral independientemente del momento, y por estas experiencias en el ambiente laboral en el último año. Estos resultados se pueden apreciar en la tabla 2.

```{r include=FALSE, message=FALSE, echo=FALSE}
#Tabla 2. Tipos de violencia

tabla2 <- data2 %>% 
  select(starts_with("agresion") & !ends_with("quien")) %>% 
  tbl_summary(label = list(agresion_fisica = "Agresión física",
                           agresion_fisica_12m = "Agresión física (últimos 12 meses)",
                           agresion_insulto = "Insultos",
                           agresion_insulto_12m = "Insultos (últimos 12 meses)",
                           agresion_amenaza = "Amenazas",
                           agresion_amenaza_12m = "Amenazas (últimos 12 meses)",
                           agresion_sexual = "Acoso sexual",
                           agresion_sexual_12m = "Acoso sexual (últimos 12 meses)"
                           ),
              missing = "no") %>% 
              modify_header(label ~ "**Características**") %>%
              modify_caption("**Tabla 2: Resumen de diversos tipos de agresión reportados por profesionales de salud**")

tabla2

```

```{r echo=FALSE, message=FALSE}
tabla2
```

#### Corrupción y discriminación

Con respecto a la corrupción, los participantes respondieron sobre la percepción de corrupción en el establecimiento de salud y sobre su experiencia alrededor de discriminación en establecimientos de salud. Los resultados se muestran en la tabla 3.

```{r include=FALSE, message=FALSE, echo=FALSE}
#Tabla 3. Corrupción y discrimación

tabla3 <- data2 %>% 
  select(corrupcion, discriminacion) %>% 
  tbl_summary(label = list(corrupcion = "Percepción de corrupción en la institución",
                   discriminacion = "Percepción de discriminación en establecimientos de salud")) %>% 
              modify_header(label ~ "**Características**") %>%
              modify_caption("**Tabla 3: Percepción de corrupción y discriminación en los establecimientos de salud**")

tabla3
```

```{r message=FALSE, echo=FALSE}

tabla3

```


### Variables sociodemográficas asociadas a violencia {.tabset}

```{r echo=FALSE, message=FALSE, include=FALSE}
# Tabla 4. Factores asociados a violencia fisica

bivariado_violencia <- function(data) {
  
outcome <- colnames(data)[startsWith(colnames(data), "agresion") & !endsWith(colnames(data), "quien") &  !endsWith(colnames(data), "12m")]
  
tables <- list()

  for (i in outcome) {

tabla <- data %>% 
  select(c(edad, profesion, sexo, grupo_etnico, all_of(i))) %>% 
  tbl_summary(by = !!sym(i),
              statistic = list(edad ~ "{median} ({min} - {max})"),
              percent = "row",
              label = list(edad = "Edad (años)",
               profesion = "Profesión",
               sexo = "Sexo",
               grupo_etnico = "Grupo étnico"
               )) %>%
  add_p() %>% 
  modify_header(label ~ "**Características**") %>%
   modify_caption(paste0("**Variables asociadas a ", i,"**"))

tables[[i]] <- tabla

}  

return(tables)
}

# Generate tables
tables_list <- bivariado_violencia(data2)

tables_list$agresion_fisica

```

#### Agresión física

```{r echo=FALSE, message=FALSE}
tables_list$agresion_fisica
```

#### Insultos

```{r echo=FALSE, message=FALSE}
tables_list$agresion_insulto
```

#### Amenazas

```{r echo=FALSE, message=FALSE}
tables_list$agresion_amenaza
```

#### Acoso

```{r echo=FALSE, message=FALSE}
tables_list$agresion_sexual
```

### Variables sociodemográficas asociadas a la percepción de corrupción

```{r echo=FALSE, message=FALSE, include=FALSE}
# Tabla 5. Factores asociados a percepción de corrupción
tabla5 <- data2 %>% 
  select(edad, profesion, sexo, grupo_etnico, corrupcion_2) %>% 
  tbl_summary(by = corrupcion_2,
              statistic = list(edad ~ "{median} ({min} - {max})"),
              percent = "row",
              label = list(edad = "Edad (años)",
               profesion = "Profesión",
               sexo = "Sexo",
               grupo_etnico = "Grupo étnico"
               )) %>%
  add_p() %>% 
  modify_header(label ~ "**Características**") %>%
   modify_caption(paste0("**Variables asociadas a la perción de corrupción**"))

```

```{r echo=FALSE, message=FALSE}

tabla5

```


### Otras a explorar

```{r}
#dejar_eess

```


## Recomendaciones

- Crear un código de identificación por participante que sea único y eliminar los nombres completos de la base de datos.

 ![Ejemplos de los id en la base de datos](image/id_capture.png)
 
 Si bien hay 191 participantes, solo hay 175 códigos. En la imagen se puede apreciar que dos participantes con el código 007, por ejemplo.
 
 - Definir bien las variables y brindar opciones de respuesta para que la persona comprenda qué se le está preguntando.
 
 Por ejemplo, la variable area de trabajo tiene respuestas que se refieren a la región, al puesto que ocupa la persona, al programa, al departamento, etc.
 
  ![Ejemplos de las respuestas de "area de trabajo" en la base de datos](image/area_trabajo_capture.png)
 - Brindar un desplegable para departamento, provincia y distrito. Esto facilita la limpieza de la base de datos y evita respuestas erroneas. 
 
 Por ejemplo, la variable de departamento tiene respuestas no plausibles como "San Borja" o "Tarma"
 
 - Crear una variable por idioma. Esto es posible dependiendo del software/plataforma que se utilice para crear la encuesta. Un ejemplo de un software libre es Redcap, pero necesitan un acceso de una entidad académica. Hay una opción para crear preguntas de opción multiples y almacenar los resultados en diferentes variables de tipo sí/no.
 
 - Considerar colocar restricciones para algunas variables numéricas. Por ejemplo, en el caso del tiempo en años viviendo en el establecimiento, hay valores inconsistentes. Esto se puede evitar colocando un máximo de años que sera creíble (¿menos de 100?)
 
   ![Ejemplos de las respuestas de "tiempo en establecimiento" en la base de datos](image/tiempo_eess_capture.png)
 
 - No se encuentran factores sociodemográficos asociados, pero es posible que sea debido al tamaño de muestra. Buscar hacer al encuesta representativa e incluir grupos de interés. Por ejemplo, ciertos grupos étnicos podrían presentar más riesgo de enfrentar ciertos tipos de violencia.